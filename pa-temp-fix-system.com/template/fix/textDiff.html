<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PA 文本差异对比</title>
    <link href="../css_js/bootstrap-5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <script src="../css_js/script/jquery-3.7.0.min.js"></script>
    <script src="../css_js/bootstrap-5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.staticfile.org/axios/0.18.0/axios.min.js"></script>
    <script src="../css_js/script/qs.min.js"></script>
    <!--粒子特效-->
    <link rel="stylesheet" href="../css_js/own/lizi.css">
</head>
<body>
<div class="container text-center" id="app">
           <div class="container">
            <div class="left">
                <div class="input-area">
                    <el-input
                        v-model="original"
                        type="textarea"
                        placeholder="请输入左侧文本1"
                        resize="none"
                    ></el-input>
                </div>
                <div class="preview-area" v-html="originalHtml"></div>
            </div>

            <div class="axis">
                <div class="axis-line"></div>
                <el-button 
                    type="primary" 
                    class="process-btn"
                    @click="processText"
                    :loading="loading"
                >处理</el-button>
                <div class="axis-line"></div>
            </div>

            <div class="right">
                <div class="input-area">
                    <el-input
                        v-model="revised"
                        type="textarea"
                        placeholder="请输入右侧文本"
                        resize="none"
                    ></el-input>
                </div>
                <div class="preview-area" v-html="revisedHtml"></div>
            </div>
        </div>


</div>

</body>
</html>
<script src="../css_js/own/lizi.js"></script>


<script>

    const {createApp, ref,onMounted} = Vue


    createApp({

        data() {
            this.initPage();
            return {
                message: 'PA 文本差异对比',
                original: '',
                revised: '',
                originalHtml:"",
                revisedHtml:"",
                errorMsg: '',
                successMsg: '',
                loading: '',
                env:"",
                envMsg:"",
                url:"http://172.16.29.23:90/php/controller",
                header: {
                    headers: {
                        'Content-Type': 'application/json',
                        // 其他自定义头
                    }
                }
            }
        },

        methods: {
            async initPage(){
                const data = {
                    action: "textDiff",
                    params: {},
                };
                this.header = {
                    headers: {
                        'Content-Type': 'application/json',
                        // 其他自定义头
                    }
                };
                this.url = "http://172.16.29.23:90/php/controller";
                let res = await axios.post(`${this.url}/search.php`, data,this.header).catch(function (error) {
                    this.errorMsg = "网络错误";
                });
                this.loading = "";
                if (res.status === 200) {
                    this.env = res.data.env;
                    this.envMsg = this.env == 'test' ? 'Test环境' :  (this.env == 'local' ?  '开发环境' :  (this.env == 'uat' ?  'UAT环境' : '生产环境'));
                }

            },
            async update() {
                this.loading = "............请等待，正在处理数据中..........";
                this.errorMsg = "";

                this.loading = "";
            },
            async search() {
                this.loading = "............请等待，正在处理数据中..........";
                this.errorMsg = "";

                const data = {
                    action: "textDiff",
                    params: {
                        original: this.original,
                        revised: this.revised,
                    },
                };
                let res = await axios.post(`${this.url}/search.php`, data,this.header).catch(function (error) {
                    this.errorMsg = "网络错误";
                });
                console.log(res)
                this.loading = "";
                if (res.status === 200) {
                    this.revisedHtml = res.data.data.revised;
                    this.originalHtml = res.data.data.original;
                }

            }
        },


    }).mount('#app')


</script>